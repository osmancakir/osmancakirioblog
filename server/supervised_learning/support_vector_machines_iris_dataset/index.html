<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130208509-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-130208509-1');
    </script>


    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Support Vector Machines Iris Dataset" />
<meta property="og:description" content="Prediction of Iris Flower Species with Support Vector Machines" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://osmancakir.io/supervised_learning/support_vector_machines_iris_dataset/" />
<meta property="article:published_time" content="2018-12-02T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-12-02T00:00:00&#43;00:00"/>

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Support Vector Machines Iris Dataset"/>
<meta name="twitter:description" content="Prediction of Iris Flower Species with Support Vector Machines"/>
<meta name="generator" content="Hugo 0.54.0" /> 
    
    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Support Vector Machines Iris Dataset",
  "url": "https://osmancakir.io/supervised_learning/support_vector_machines_iris_dataset/",
  "wordCount": "1228",
  "datePublished": "2018-12-02T00:00:00&#43;00:00",
  "dateModified": "2018-12-02T00:00:00&#43;00:00",
  "author": {
    "@type": "Person",
    "name": "Osman Cakir"
  },
  "description": "Prediction of Iris Flower Species with Support Vector Machines"
}
</script> 

    <title>Support Vector Machines Iris Dataset</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

     
    <link rel="stylesheet" href="https://osmancakir.io/css/custom.css">
    <link rel="stylesheet" href="https://osmancakir.io/css/syntax.css">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">
        
    <link href="" rel="alternate" type="application/rss+xml" title="osman cakir" /> 
    
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container">
            <a class="navbar-brand" href="https://osmancakir.io">Osman Cakir</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            DS/CC Notes
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://osmancakir.io#supervised_learning">Supervised Learning</a>
                            <a class="dropdown-item" href="https://osmancakir.io#unsupervised_learning">Unsupervised Learning</a>
                            <a class="dropdown-item" href="https://osmancakir.io#deep_learning">Deep Learning</a>
                            <a class="dropdown-item" href="https://osmancakir.io#nlp">NLP</a>
                            <a class="dropdown-item" href="https://osmancakir.io#recommender_systems">Recommender Systems</a>
                            <a class="dropdown-item" href="https://osmancakir.io#python">Python</a>
                            <a class="dropdown-item" href="https://osmancakir.io#data_visualization">Data Visualization</a>
                            <a class="dropdown-item" href="https://osmancakir.io#postgresql">PostgreSQL</a>
                            <a class="dropdown-item" href="https://osmancakir.io#big_data">Big Data</a>
                            <a class="dropdown-item" href="https://osmancakir.io#creative_coding">Creative Coding</a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://osmancakir.io#articles">Articles</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            About
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://osmancakir.io/about/osman_cakir/">About Osman</a>
                            <a class="dropdown-item" href="https://github.com/osmancakir">GitHub</a>
                            <a class="dropdown-item" href="https://twitter.com/osmancakirio">Twitter</a>
                            <a class="dropdown-item" href="https://www.instagram.com/osmancakirio/">Instagram</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                 


<article>
  <div class="technical_note">
  <header>
      <div class="alert alert-warning flashcard_ad" role="alert">
          Would you like to support my research and work? <a href="https://www.patreon.com/osmancakirio" class="alert-link">My patreon link is here.</a> Thank you, I will remember you!
      </div>
    <h1 class="technical_note_title">Support Vector Machines Iris Dataset</h1>
    <div class="technical_note_date">
      <time datetime=" 2018-12-02T00:00:00Z "> 02 Dec 2018</time>
    </div>
  </header>
  <div class="content">
  

<p>We will be analyzing the famous iris data set in this small project!</p>

<h2 id="the-data">The Data</h2>

<p>For this series of lectures, we will be using the famous <a href="http://en.wikipedia.org/wiki/Iris_flower_data_set">Iris flower data set</a>.</p>

<p>The Iris flower data set or Fisher&rsquo;s Iris data set is a multivariate data set introduced by Sir Ronald Fisher in the 1936 as an example of discriminant analysis.</p>

<p>The data set consists of 50 samples from each of three species of Iris (Iris setosa, Iris virginica and Iris versicolor), so 150 total samples. Four features were measured from each sample: the length and the width of the sepals and petals, in centimeters.</p>

<p>Here&rsquo;s a picture of the three different Iris types:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># The Iris Setosa</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://upload.wikimedia.org/wikipedia/commons/5/56/Kosaciec_szczecinkowaty_Iris_setosa.jpg&#39;</span>
<span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></code></pre></div>
<p><img src="support_vector_machines_iris_dataset_2_0.jpeg" alt="jpeg" /></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># The Iris Versicolor</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://upload.wikimedia.org/wikipedia/commons/4/41/Iris_versicolor_3.jpg&#39;</span>
<span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></code></pre></div>
<p><img src="support_vector_machines_iris_dataset_3_0.jpeg" alt="jpeg" /></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># The Iris Virginica</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://upload.wikimedia.org/wikipedia/commons/9/9f/Iris_virginica.jpg&#39;</span>
<span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></code></pre></div>
<p><img src="support_vector_machines_iris_dataset_4_0.jpeg" alt="jpeg" /></p>

<p>The iris dataset contains measurements for 150 iris flowers from three different species.</p>

<p>The three classes in the Iris dataset:</p>

<pre><code>Iris-setosa (n=50)
Iris-versicolor (n=50)
Iris-virginica (n=50)
</code></pre>

<p>The four features of the Iris dataset:</p>

<pre><code>sepal length in cm
sepal width in cm
petal length in cm
petal width in cm
</code></pre>

<h2 id="get-the-data">Get the data</h2>

<p>**Use seaborn to get the iris data by using: iris = sns.load_dataset(&lsquo;iris&rsquo;) **</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span></code></pre></div>
<p>Let&rsquo;s visualize the data and get you started!</p>

<h2 id="exploratory-data-analysis">Exploratory Data Analysis</h2>

<p>Time to put your data viz skills to the test! Try to recreate the following plots, make sure to import the libraries you&rsquo;ll need!</p>

<p><strong>Import some libraries you think you&rsquo;ll need.</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span></code></pre></div>
<p>** Create a pairplot of the data set. Which flower species seems to be the most separable?**</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Setosa is the most separable. </span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Dark2&#39;</span><span class="p">)</span></code></pre></div>
<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x12afb9cc0&gt;
</code></pre>

<p><img src="support_vector_machines_iris_dataset_10_1.png" alt="png" /></p>

<p><strong>Create a kde plot of sepal_length versus sepal width for setosa species of flower.</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">setosa</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;setosa&#39;</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span> <span class="n">setosa</span><span class="p">[</span><span class="s1">&#39;sepal_width&#39;</span><span class="p">],</span> <span class="n">setosa</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">],</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s2">&#34;plasma&#34;</span><span class="p">,</span> <span class="n">shade</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">shade_lowest</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></code></pre></div>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12f102080&gt;
</code></pre>

<p><img src="support_vector_machines_iris_dataset_12_1.png" alt="png" /></p>

<h1 id="train-test-split">Train Test Split</h1>

<p>** Split your data into a training set and a testing set.**</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">)</span></code></pre></div>
<h1 id="train-a-model">Train a Model</h1>

<p>Now its time to train a Support Vector Machine Classifier.</p>

<p><strong>Call the SVC() model from sklearn and fit the model to the training data.</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">svc_model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">svc_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span></code></pre></div>
<pre><code>SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape=None, degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=False, random_state=None, shrinking=True,
  tol=0.001, verbose=False)
</code></pre>

<h2 id="model-evaluation">Model Evaluation</h2>

<p><strong>Now get predictions from the model and create a confusion matrix and a classification report.</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">predictions</span> <span class="o">=</span> <span class="n">svc_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span><span class="n">confusion_matrix</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">predictions</span><span class="p">))</span></code></pre></div>
<pre><code>[[15  0  0]
 [ 0 13  1]
 [ 0  0 16]]
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">predictions</span><span class="p">))</span></code></pre></div>
<pre><code>             precision    recall  f1-score   support

     setosa       1.00      1.00      1.00        15
 versicolor       1.00      0.93      0.96        14
  virginica       0.94      1.00      0.97        16

avg / total       0.98      0.98      0.98        45
</code></pre>

<p>Wow! You should have noticed that your model was pretty good! Let&rsquo;s see if we can tune the parameters to try to get even better (unlikely, and you probably would be satisfied with these results in real like because the data set is quite small, but I just want you to practice using GridSearch.</p>

<h2 id="gridsearch-practice">Gridsearch Practice</h2>

<p>** Import GridsearchCV from SciKit Learn.**</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span></code></pre></div>
<p><strong>Create a dictionary called param_grid and fill out some parameters for C and gamma.</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.001</span><span class="p">]}</span> </code></pre></div>
<p>** Create a GridSearchCV object and fit it to the training data.**</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">SVC</span><span class="p">(),</span><span class="n">param_grid</span><span class="p">,</span><span class="n">refit</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span></code></pre></div>
<pre><code>Fitting 3 folds for each of 16 candidates, totalling 48 fits
[CV] gamma=1, C=0.1 ..................................................
[CV] ......................................... gamma=1, C=0.1 -   0.0s
[CV] gamma=1, C=0.1 ..................................................
[CV] ......................................... gamma=1, C=0.1 -   0.0s
[CV] gamma=1, C=0.1 ..................................................
[CV] ......................................... gamma=1, C=0.1 -   0.0s
[CV] gamma=0.1, C=0.1 ................................................
[CV] ....................................... gamma=0.1, C=0.1 -   0.0s
[CV] gamma=0.1, C=0.1 ................................................
[CV] ....................................... gamma=0.1, C=0.1 -   0.0s
[CV] gamma=0.1, C=0.1 ................................................
[CV] ....................................... gamma=0.1, C=0.1 -   0.0s
[CV] gamma=0.01, C=0.1 ...............................................
[CV] ...................................... gamma=0.01, C=0.1 -   0.0s
[CV] gamma=0.01, C=0.1 ...............................................
[CV] ...................................... gamma=0.01, C=0.1 -   0.0s
[CV] gamma=0.01, C=0.1 ...............................................
[CV] ...................................... gamma=0.01, C=0.1 -   0.0s
[CV] gamma=0.001, C=0.1 ..............................................
[CV] ..................................... gamma=0.001, C=0.1 -   0.0s
[CV] gamma=0.001, C=0.1 ..............................................
[CV] ..................................... gamma=0.001, C=0.1 -   0.0s
[CV] gamma=0.001, C=0.1 ..............................................
[CV] ..................................... gamma=0.001, C=0.1 -   0.0s
[CV] gamma=1, C=1 ....................................................
[CV] ........................................... gamma=1, C=1 -   0.0s
[CV] gamma=1, C=1 ....................................................
[CV] ........................................... gamma=1, C=1 -   0.0s
[CV] gamma=1, C=1 ....................................................
[CV] ........................................... gamma=1, C=1 -   0.0s
[CV] gamma=0.1, C=1 ..................................................
[CV] ......................................... gamma=0.1, C=1 -   0.0s
[CV] gamma=0.1, C=1 ..................................................
[CV] ......................................... gamma=0.1, C=1 -   0.0s
[CV] gamma=0.1, C=1 ..................................................
[CV] ......................................... gamma=0.1, C=1 -   0.0s
[CV] gamma=0.01, C=1 .................................................
[CV] ........................................ gamma=0.01, C=1 -   0.0s
[CV] gamma=0.01, C=1 .................................................
[CV] ........................................ gamma=0.01, C=1 -   0.0s
[CV] gamma=0.01, C=1 .................................................
[CV] ........................................ gamma=0.01, C=1 -   0.0s
[CV] gamma=0.001, C=1 ................................................
[CV] ....................................... gamma=0.001, C=1 -   0.0s
[CV] gamma=0.001, C=1 ................................................
[CV] ....................................... gamma=0.001, C=1 -   0.0s
[CV] gamma=0.001, C=1 ................................................
[CV] ....................................... gamma=0.001, C=1 -   0.0s
[CV] gamma=1, C=10 ...................................................
[CV] .......................................... gamma=1, C=10 -   0.0s
[CV] gamma=1, C=10 ...................................................
[CV] .......................................... gamma=1, C=10 -   0.0s
[CV] gamma=1, C=10 ...................................................
[CV] .......................................... gamma=1, C=10 -   0.0s
[CV] gamma=0.1, C=10 .................................................
[CV] ........................................ gamma=0.1, C=10 -   0.0s
[CV] gamma=0.1, C=10 .................................................
[CV] ........................................ gamma=0.1, C=10 -   0.0s
[CV] gamma=0.1, C=10 .................................................
[CV] ........................................ gamma=0.1, C=10 -   0.0s
[CV] gamma=0.01, C=10 ................................................
[CV] ....................................... gamma=0.01, C=10 -   0.0s
[CV] gamma=0.01, C=10 ................................................
[CV] ....................................... gamma=0.01, C=10 -   0.0s
[CV] gamma=0.01, C=10 ................................................
[CV] ....................................... gamma=0.01, C=10 -   0.0s
[CV] gamma=0.001, C=10 ...............................................
[CV] ...................................... gamma=0.001, C=10 -   0.0s
[CV] gamma=0.001, C=10 ...............................................
[CV] ...................................... gamma=0.001, C=10 -   0.0s
[CV] gamma=0.001, C=10 ...............................................
[CV] ...................................... gamma=0.001, C=10 -   0.0s
[CV] gamma=1, C=100 ..................................................
[CV] ......................................... gamma=1, C=100 -   0.0s
[CV] gamma=1, C=100 ..................................................
[CV] ......................................... gamma=1, C=100 -   0.0s
[CV] gamma=1, C=100 ..................................................
[CV] ......................................... gamma=1, C=100 -   0.0s
[CV] gamma=0.1, C=100 ................................................
[CV] ....................................... gamma=0.1, C=100 -   0.0s
[CV] gamma=0.1, C=100 ................................................
[CV] ....................................... gamma=0.1, C=100 -   0.0s
[CV] gamma=0.1, C=100 ................................................
[CV] ....................................... gamma=0.1, C=100 -   0.0s
[CV] gamma=0.01, C=100 ...............................................
[CV] ...................................... gamma=0.01, C=100 -   0.0s
[CV] gamma=0.01, C=100 ...............................................
[CV] ...................................... gamma=0.01, C=100 -   0.0s
[CV] gamma=0.01, C=100 ...............................................
[CV] ...................................... gamma=0.01, C=100 -   0.0s
[CV] gamma=0.001, C=100 ..............................................
[CV] ..................................... gamma=0.001, C=100 -   0.0s
[CV] gamma=0.001, C=100 ..............................................
[CV] ..................................... gamma=0.001, C=100 -   0.0s
[CV] gamma=0.001, C=100 ..............................................
[CV] ..................................... gamma=0.001, C=100 -   0.0s


[Parallel(n_jobs=1)]: Done  40 tasks       | elapsed:    0.2s
[Parallel(n_jobs=1)]: Done  48 out of  48 | elapsed:    0.2s finished





GridSearchCV(cv=None, error_score='raise',
       estimator=SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape=None, degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=False, random_state=None, shrinking=True,
  tol=0.001, verbose=False),
       fit_params={}, iid=True, n_jobs=1,
       param_grid={'gamma': [1, 0.1, 0.01, 0.001], 'C': [0.1, 1, 10, 100]},
       pre_dispatch='2*n_jobs', refit=True, scoring=None, verbose=2)
</code></pre>

<p>** Now take that grid model and create some predictions using the test set and create classification reports and confusion matrices for them. Were you able to improve?**</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grid_predictions</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">grid_predictions</span><span class="p">))</span></code></pre></div>
<pre><code>[[15  0  0]
 [ 0 13  1]
 [ 0  0 16]]
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">grid_predictions</span><span class="p">))</span></code></pre></div>
<pre><code>             precision    recall  f1-score   support

     setosa       1.00      1.00      1.00        15
 versicolor       1.00      0.93      0.96        14
  virginica       0.94      1.00      0.97        16

avg / total       0.98      0.98      0.98        45
</code></pre>

<p>You should have done about the same or exactly the same, this makes sense, there is basically just one point that is too noisey to grab, which makes sense, we don&rsquo;t want to have an overfit model that would be able to grab that.</p>

<h2 id="great-job">Great Job!</h2>

</div>
  <aside>
      <div class="bug_reporting">
          <h4>Find an error or bug?</h4>
          <p>Everything on this site is available on GitHub. Head to <a href='https://github.com/osmancakir/osmancakirioblog/issues/new'>and submit a suggested change</a>. You can also message me directly on <a href='https://twitter.com/osmancakirio'>Twitter</a>.</p>
      </div>
      </aside>

    </div>
</article>




            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">This project contains 17 pages and is available on <a href="https://github.com/osmancakir/osmancakirioblog">GitHub</a>. Copyright &copy; Osman Cakir, <time datetime="2018">2018</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>